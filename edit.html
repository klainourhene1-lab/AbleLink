<?php 
$storyId = isset($story['id']) ? (int)$story['id'] : 0;
$storyTitle = isset($story['title']) ? htmlspecialchars($story['title'], ENT_QUOTES, 'UTF-8') : '';
$storyUserName = isset($story['user_name']) ? htmlspecialchars($story['user_name'], ENT_QUOTES, 'UTF-8') : '';
$storyEmail = isset($story['user_email']) ? htmlspecialchars($story['user_email'], ENT_QUOTES, 'UTF-8') : '';
$storyContent = isset($story['content']) ? htmlspecialchars($story['content'], ENT_QUOTES, 'UTF-8') : '';
$storyImage = isset($story['image']) && !empty($story['image']) ? htmlspecialchars($story['image'], ENT_QUOTES, 'UTF-8') : '';
?>
<div style="max-width:800px; margin:50px auto; background:white; padding:40px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.1);">
    <h1 style="text-align:center; margin-bottom:30px; color:#6366f1;">Modifier la Success Story</h1>
    
    <a href="/ablelink/stories/show/<?php echo $storyId; ?>" style="color:#6366f1; text-decoration:none; margin-bottom:20px; display:inline-block;">
        ← Retour à la story
    </a>
    
    <form action="/ablelink/stories/edit/<?php echo $storyId; ?>" method="POST" enctype="multipart/form-data" style="margin-top:20px;">
        <input type="text" name="user_name" value="<?php echo $storyUserName; ?>" placeholder="Votre nom *" required 
               style="width:100%; padding:15px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
        
        <input type="email" name="user_email" value="<?php echo $storyEmail; ?>" placeholder="Votre email (optionnel)" 
               style="width:100%; padding:15px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
        
        <input type="text" name="title" value="<?php echo $storyTitle; ?>" placeholder="Titre de votre story *" required 
               style="width:100%; padding:15px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
        
        <textarea name="content" rows="12" placeholder="Racontez votre success story... *" required 
                  style="width:100%; padding:15px; margin:10px 0; border:1px solid #ddd; border-radius:8px; font-family:inherit;"><?php echo $storyContent; ?></textarea>
        
        <?php if($storyImage !== ''): ?>
            <div style="margin:15px 0;">
                <p style="color:#64748b; margin-bottom:10px;">Image actuelle :</p>
                <img src="/ablelink/public/uploads/<?php echo $storyImage; ?>" 
                     style="width:100%; max-height:300px; object-fit:cover; border-radius:8px; margin:10px 0;">
            </div>
        <?php endif; ?>
        
        <input type="file" name="image" accept="image/*" style="margin:15px 0;">
        <p style="color:#64748b; font-size:0.9rem;">Laisser vide pour garder l'image actuelle</p>
        
        <div style="text-align:center; margin-top:30px;">
            <button type="submit" style="background:#10b981; color:white; padding:15px 40px; border:none; border-radius:8px; font-size:1.1rem; cursor:pointer;">
                Sauvegarder les modifications
            </button>
        </div>
    </form>
</div>

